//cc MaxVisibilityWithCombiner Application to find the highest visibility, using a combiner function for efficiencyimport org.apache.hadoop.fs.Path;import org.apache.hadoop.io.IntWritable;import org.apache.hadoop.io.Text;import org.apache.hadoop.mapreduce.Job;import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;// vv MaxTemperatureWithCombinerpublic class MaxVisibilityWithCombiner {Ê public static void main(String[] args) throws Exception {Ê Ê if (args.length != 2) {Ê Ê Ê System.err.println("Usage: MaxVisibilityWithCombiner <input path> " +Ê Ê Ê Ê Ê "<output path>");Ê Ê Ê System.exit(-1);Ê Ê }Ê Ê Job job = new Job();Ê Ê job.setJarByClass(MaxVisibilityWithCombiner.class);Ê Ê job.setJobName("highest visibility");Ê Ê FileInputFormat.addInputPath(job, new Path(args[0]));Ê Ê FileOutputFormat.setOutputPath(job, new Path(args[1]));Ê Ê job.setMapperClass(MaxVisibilityMapper.class);Ê Ê /*[*/job.setCombinerClass(MaxVisibilityReducer.class)/*]*/;Ê Ê job.setReducerClass(MaxVisibilityReducer.class);Ê Ê job.setOutputKeyClass(Text.class);Ê Ê job.setOutputValueClass(IntWritable.class);Ê Ê System.exit(job.waitForCompletion(true) ? 0 : 1);Ê }}// ^^ MaxVisibilityWithCombiner